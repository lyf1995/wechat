<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="cn.com.lyf.wechat.dao.UserDao">
	<select id="selectUserByName" resultType="cn.com.lyf.wechat.entity.User">
	     select * from t_user where user_name = #{username} and password = #{password} and is_delete = '0'
	</select>

	<select id="selectUsername" resultType="cn.com.lyf.wechat.entity.User">
		select * from t_user where user_name = #{username} and is_delete = '0'
	</select>

	<select id="selectAllUser" resultType="cn.com.lyf.wechat.entity.User">
		select * from t_user u where is_delete = '0'
		<if test="user.id != null">
			AND u.id = #{user.id}
		</if>
		<if test="user.userName != null">
			AND u.user_name LIKE #{user.userName}
		</if>
		<if test="user.realName != null">
			AND u.real_name LIKE #{user.realName}
		</if>
		<if test="user.roleId != ''">
			AND u.role_Id = #{user.roleId}
		</if>
	</select>

	<update id="updatePasswordById">
		UPDATE t_user SET password = #{newPassword} WHERE id = #{id}
	</update>

	<update id="updateLastLoginById">
		UPDATE t_user SET last_login = #{lastLogin}, last_ip = #{lastIp} WHERE id = #{id}
	</update>

	<insert id="newUser">
		INSERT INTO t_user (user_name, real_name, password, role_name,role_id
		<if test="user.moblie != null">
			,moblie
		</if>
		<if test="user.email != null">
			,email
		</if>
		<if test="user.department != null">
			,department
		</if>
		<if test="user.birthday != null">
			,birthday
		</if>
		<if test="user.city != null">
			,city
		</if>
		<if test="user.qq != null">
			,qq
		</if>
		<if test="user.weixin != null">
			,weixin
		</if>
		<if test="user.sex != null">
			,sex
		</if>
		,create_by
		,create_time,status)
		VALUES
		(#{user.userName},#{user.realName},#{user.password}, #{user.roleName}, #{user.roleId}
		<if test="user.moblie != null">
			,#{user.moblie}
		</if>
		<if test="user.moblie != null">
			,#{user.moblie}
		</if>
		<if test="user.email != null">
			,#{user.email}
		</if>
		<if test="user.department != null">
			,#{user.department}
		</if>
		<if test="user.birthday != null">
			,#{user.birthday}
		</if>
		<if test="user.city != null">
			,#{user.city}
		</if>
		<if test="user.qq != null">
			,#{user.qq}
		</if>
		<if test="user.weixin != null">
			,#{user.weixin}
		</if>
		<if test="user.sex != null">
			,#{user.sex}
		</if>
		,#{user.createBy}
		,#{user.createTime},#{user.status})
	</insert>
</mapper>